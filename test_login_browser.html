<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tentativo 68 - Fix PathRewrite Proxy Server</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
    <h1>Tentativo 68 - Fix PathRewrite Proxy Server</h1>
    <button onclick="testLogin()">Test Login</button>
    <div id="result"></div>

    <script>
        async function testLogin() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = 'Testing login...';
            
            // Test delle credenziali di login
            const credentials = {
                email: 'admin@example.com',
                password: 'Admin123!'
            };

            // Configura axios baseURL per il test (CORRETTO - no duplicazione)
            axios.defaults.baseURL = '';
            
            console.log('üîç Axios Configuration:', {
                baseURL: axios.defaults.baseURL,
                timeout: axios.defaults.timeout,
                headers: axios.defaults.headers
            });

            // Aggiungi interceptor per debug URL
            axios.interceptors.request.use(config => {
                console.log('üîç [REQUEST INTERCEPTOR] Full request config:', {
                    url: config.url,
                    baseURL: config.baseURL,
                    fullURL: config.baseURL + config.url,
                    method: config.method
                });
                return config;
            });
            
            try {
                console.log('üöÄ Sending login request...');
                const response = await axios.post('/api/v1/auth/login', credentials);
                
                console.log('‚úÖ LOGIN SUCCESS:', response.data);
                document.getElementById('result').innerHTML = `
                    <div style="color: green; font-weight: bold;">‚úÖ LOGIN SUCCESS</div>
                    <pre>${JSON.stringify(response.data, null, 2)}</pre>
                `;
            } catch (error) {
                console.error('‚ùå LOGIN FAILED:', error);
                console.log('üîç [ERROR DEBUG] Request details:', {
                    url: error.config?.url,
                    baseURL: error.config?.baseURL,
                    fullURL: error.config?.baseURL + error.config?.url,
                    actualURL: error.request?.responseURL
                });
                document.getElementById('result').innerHTML = `
                    <div style="color: red; font-weight: bold;">‚ùå LOGIN FAILED</div>
                    <div>Error: ${error.message}</div>
                    <div>Status: ${error.response?.status}</div>
                    <div>Config URL: ${error.config?.url}</div>
                    <div>Config BaseURL: ${error.config?.baseURL}</div>
                    <div>Full URL: ${error.config?.baseURL}${error.config?.url}</div>
                    <div>Actual URL: ${error.request?.responseURL}</div>
                `;
            }
        }
    </script>
</body>
</html>